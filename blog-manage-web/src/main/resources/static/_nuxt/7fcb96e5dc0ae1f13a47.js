(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{405:function(e,t,r){"use strict";r.r(t);r(174),r(175),r(112);var o=r(12),n=r.n(o),l={data:function(){return{categoryList:[],tagsList:[],treatiseInfo:{}}},computed:{treatiseBody:function(){return this.unescape(this.treatiseInfo.treatiseBody)}},methods:{initInfo:function(){},$imgAdd:function(e,t){var r=this,o=new FormData;o.append("image",t),n()({url:"/uploadImage",method:"post",data:o,headers:{"Content-Type":"multipart/form-data"}}).then(function(t){r.$refs.md.$img2Url(e,t.data)})},changeData:function(e,t){this.treatiseInfo.treatiseBody=t},unescape:function(html){return html.replace(html?/&(?!#?\w+;)/g:/&/g,"&amp;").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&nbsp;/g," ")},editInfo:function(e){var t=this;n.a.get("/blogTreatise/info/"+e).then(function(e){if(200==e.data.code){var r=e.data.data.object.tags;r&&(e.data.data.object.tagsList=r.split(",")),t.treatiseInfo=e.data.data.object,t.treatiseInfo.recommend=1==e.data.data.object.recommend,t.loadCategory(e.data.data.object.categoryId),t.loadTagList(e.data.data.object.tags)}})},loadCategory:function(e){var t=this;n.a.get("/blogCategory/getCategoryList").then(function(r){200==r.data.code&&(e&&r.data.data.list.forEach(function(t){t.id==e&&(t.selected=!0)}),t.categoryList=r.data.data.list)})},loadTagList:function(e){var t=this;n.a.get("/blogTags/getList").then(function(r){200==r.data.code&&(e&&r.data.data.list.forEach(function(t){-1!=e.search(t.tagName)&&(t.checked=!0)}),t.tagsList=r.data.data.list)})},updateTreatiseBody:function(){var e=this;this.treatiseInfo.recommend=this.treatiseInfo.recommend?1:0;var t=[];this.$refs.tags.forEach(function(e){console.log(e.label+"==>"+e.model),e.model&&t.push(e.label)}),this.treatiseInfo.tags=t.join(","),n.a.post("/blogTreatise/insertOrUpdate",this.treatiseInfo).then(function(t){200==t.data.code?e.$message({message:t.data.msg,type:"success"}):e.$message({message:t.data.msg,type:"warning"})})}},created:function(){var e=this.$route.query.uuid;e?this.editInfo(e):(this.loadCategory(),this.loadTagList())}},c=r(3),component=Object(c.a)(l,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{"margin-top":"10px"}},[r("el-form",{ref:"blogLeaveMessage",staticClass:"demo-ruleForm",attrs:{model:e.treatiseInfo,rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"文章标题"}},[r("el-input",{attrs:{placeholder:"请输入文章标题"},model:{value:e.treatiseInfo.treatiseTitle,callback:function(t){e.$set(e.treatiseInfo,"treatiseTitle",t)},expression:"treatiseInfo.treatiseTitle"}})],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:"5"}},[r("el-form-item",{attrs:{label:"所属类型"}},[r("el-select",{attrs:{placeholder:"请选择分类"},model:{value:e.treatiseInfo.categoryId,callback:function(t){e.$set(e.treatiseInfo,"categoryId",t)},expression:"treatiseInfo.categoryId"}},e._l(e.categoryList,function(e,t){return r("el-option",{key:t,attrs:{value:e.id,selected:e.selected,label:e.categoryName}})}),1)],1)],1),e._v(" "),r("el-col",{attrs:{span:"8"}},[r("el-form-item",{attrs:{label:"是否推荐"}},[r("el-switch",{model:{value:e.treatiseInfo.recommend,callback:function(t){e.$set(e.treatiseInfo,"recommend",t)},expression:"treatiseInfo.recommend"}})],1)],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"标签选择"}},e._l(e.tagsList,function(e,t){return r("el-checkbox",{key:t,ref:"tags",refInFor:!0,attrs:{label:e.tagName,checked:e.checked,border:""}})}),1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:"3"}},[r("el-form-item",{attrs:{label:"文章来源"}},[r("el-select",{attrs:{placeholder:"请选择来源"},model:{value:e.treatiseInfo.source,callback:function(t){e.$set(e.treatiseInfo,"source",t)},expression:"treatiseInfo.source"}},[r("el-option",{attrs:{value:"1",label:"原创"}}),e._v(" "),r("el-option",{attrs:{value:"2",label:"转载"}})],1)],1)],1),e._v(" "),r("el-col",{attrs:{span:"8"}},[r("el-form-item",{attrs:{label:"来源地"}},[r("el-input",{model:{value:e.treatiseInfo.reprintFrom,callback:function(t){e.$set(e.treatiseInfo,"reprintFrom",t)},expression:"treatiseInfo.reprintFrom"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:"13"}},[r("el-form-item",{attrs:{label:"来源url"}},[r("el-input",{model:{value:e.treatiseInfo.reprintUrl,callback:function(t){e.$set(e.treatiseInfo,"reprintUrl",t)},expression:"treatiseInfo.reprintUrl"}})],1)],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"预览内容"}},[r("el-input",{attrs:{type:"textarea",placeholder:"请输入预览内容"},model:{value:e.treatiseInfo.treatisePreview,callback:function(t){e.$set(e.treatiseInfo,"treatisePreview",t)},expression:"treatiseInfo.treatisePreview"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"文章正文"}},[r("mavon-editor",{ref:"md",attrs:{ishlj:!0},on:{imgAdd:e.$imgAdd,change:e.changeData},model:{value:e.treatiseInfo.markdownContent,callback:function(t){e.$set(e.treatiseInfo,"markdownContent",t)},expression:"treatiseInfo.markdownContent"}})],1),e._v(" "),r("el-form-item",{staticStyle:{"text-align":"center"}},[r("el-button",{attrs:{type:"primary"},on:{click:e.updateTreatiseBody}},[e._v("保存")])],1)],1)],1)},[],!1,null,null,null);t.default=component.exports}}]);