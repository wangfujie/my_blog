<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>学无止境</title>
    <meta name="keywords" content=""/>
    <meta name="description" content=""/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../skin/public/images/logo.png">
    <script src="../skin/public/js/jquery.min.js"></script>
    <script src="../skin/public/js/hc-sticky.js"></script>
    <script src="../skin/public/js/comm.js"></script>
    <script src="../common/js/head-menu.js"></script>
    <script src="../common/js/aside-left.js"></script>
    <link rel="stylesheet" type="text/css" href="../skin/public/css/pagination.css" media="screen">
    <link rel="stylesheet" type="text/css" href="../skin/public/css/index.css" >
</head>
<body>
<header>
    <div class="logo">
        <h1><a href="../index.html">Mr · 王</a></h1>
        <span>花若盛开，清风自来。</span>
    </div>
    <nav>
        <h2 id="mnavh"><span class="navicon"></span></h2>
        <ul id="starlist">
            <li><a href="../index.html">首页</a></li>
        </ul>
    </nav>
</header>
<div class="blank"></div>
<aside>
    <div class="newsbox">
        <h2 class="hometitle">推荐</h2>
        <ul class="news" id="recommend">
        </ul>
    </div>
    <div class="search">
        <input name="keyboard" id="keyboard" class="input_text" placeholder="请输入关键字词" type="text">
        <input id="keyboardQuery" name="Submit" class="input_submit" value="搜索" type="submit">
    </div>
    <div class="newsbox">
        <h2 class="hometitle">标签云</h2>
        <ul class="cloud" id="show_tags"></ul>
    </div>
    <div class="newsbox">
        <h2 class="hometitle">阅读排行</h2>
        <ul class="news" id="read_ranking"></ul>
    </div>
    <div class="newsbox">
        <h2 class="hometitle">友情链接</h2>
        <ul class="links"></ul>
    </div>
</aside>
<main id="tagsMain">
    <div class="address">
        您现在的位置是：<a href='../index.html'>首页</a>&nbsp;>&nbsp;标签信息列表&nbsp;>&nbsp;
    </div>
    <div class="bloglist">
        <ul>
            <li v-for="treatise in treatiseList">
                <h2><a :href="'/knowledge/treatise-detail.html?uuid=' + treatise.uuid">{{ treatise.treatiseTitle }}</a></h2>
                <p class="blogtext">{{ treatise.treatisePreview }}</p>
                <p class="bloginfo"><span>{{ treatise.sourceName }}</span><span>{{ treatise.createTime }}</span><span>[<a href="#2">{{ treatise.categoryName }}</a>]</span><span>阅读({{ treatise.readNum }})</span></p>
            </li>
        </ul>
    </div>
    <div class="m-style pageList"></div>
</main>
<div class="blank"></div>
<footer>
    <script>$("footer").load("/common/footer.html");</script>
</footer>
<a href="tags.html" class="cd-top cd-is-visible cd-fade-out">Top</a>
<script src="../skin/public/js/utils.js"></script>
<script src="../skin/public/js/jquery.pagination.js"></script>
<script type="text/javascript" src="../skin/public/js/vue.js"></script>
<script type="application/javascript">
    new Vue({
        el: "#tagsMain",
        data: {treatiseList:[]},
        methods:{
            getList:function (pageNum,tagName) {
                var self = this;
                $.ajax({
                    url: "/blogTreatise/list",
                    type: "GET",
                    data: {"currentPage": pageNum, "pageSize": 10, "tagInfo": tagName}
                }).then(function (value) {
                    if (value.code == 200) {
                        $('.pageList').pagination({
                            pageCount: value.data.page.pages,
                            current: value.data.page.current,
                            coping: true,
                            homePage: '首页',
                            endPage: '末页',
                            prevContent: '上页',
                            nextContent: '下页',
                            callback: function (api) {
                                self.getList(api.getCurrent(),tagName);
                            }
                        });
                        self.treatiseList = value.data.page.records;
                    }
                }).fail(function () {
                    console.log("获取失败");
                });
            }
            },
        created: function () {
            //获取参数
            var params = getRequestParams(window.location.search);
            var tagName = params.tagName;
            this.getList(1, tagName);
        }
    });
</script>
</body>
</html>